import{g as U,r as c,j as e,u as oe,D as Y,b as Q,c as Z,d as ee,e as te,L as ie,m as E,F as le,U as J,P as ae,B,a as z,C as ne,I as de,f as ce,R as pe}from"./chunks/index-B1xDN1qa.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=U("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=U("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=U("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=U("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=U("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=U("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=U("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=U("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),fe=({isOpen:p,onClose:u,tourName:D,tourUrl:w,embedScript:b,embedScriptResponsive:d})=>{const[j,m]=c.useState(!1),[v,N]=c.useState(!1);c.useEffect(()=>{const l=T=>{T.key==="Escape"&&p&&u()};return p&&document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}},[p,u]);const g=async(l,T)=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(l);else{const x=document.createElement("textarea");x.value=l,x.style.position="fixed",x.style.opacity="0",document.body.appendChild(x),x.select(),document.execCommand("copy"),document.body.removeChild(x)}T==="standard"?(m(!0),setTimeout(()=>m(!1),2e3)):(N(!0),setTimeout(()=>N(!1),2e3))}catch{alert("Failed to copy to clipboard. Please select and copy manually.")}};return p?e.jsx("div",{className:`h3tm-modal-overlay h3tm-embed-modal ${p?"h3tm-modal-show":""}`,role:"dialog",onClick:l=>{l.target===l.currentTarget&&u()},children:e.jsxs("div",{className:"h3tm-modal-container h3tm-embed-container",children:[e.jsxs("div",{className:"h3tm-modal-header",children:[e.jsxs("h3",{children:["Embed Code for: ",D]}),e.jsx("button",{type:"button",className:"h3tm-modal-close",onClick:u,style:{background:"none",border:"none",fontSize:"28px",cursor:"pointer",color:"#666",padding:"0",width:"30px",height:"30px",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:l=>l.currentTarget.style.color="#000",onMouseLeave:l=>l.currentTarget.style.color="#666","aria-label":"Close modal",children:"Ã—"})]}),e.jsxs("div",{className:"h3tm-modal-body",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tour URL:"})," ",e.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:w})]}),e.jsxs("div",{className:"h3tm-embed-option",children:[e.jsx("h4",{children:"Standard Embed (Fixed Height)"}),e.jsx("textarea",{id:"h3tm-embed-standard",className:"h3tm-embed-code",value:b,readOnly:!0}),e.jsx("button",{type:"button",className:`button button-primary h3tm-copy-embed ${j?"h3tm-copy-success":""}`,onClick:()=>g(b,"standard"),children:j?"âœ“ Copied!":"Copy to Clipboard"})]}),e.jsxs("div",{className:"h3tm-embed-option",children:[e.jsx("h4",{children:"Responsive Embed (16:9 Aspect Ratio)"}),e.jsx("textarea",{id:"h3tm-embed-responsive",className:"h3tm-embed-code",value:d,readOnly:!0}),e.jsx("button",{type:"button",className:`button button-primary h3tm-copy-embed ${v?"h3tm-copy-success":""}`,onClick:()=>g(d,"responsive"),children:v?"âœ“ Copied!":"Copy to Clipboard"})]}),e.jsxs("div",{className:"h3tm-embed-instructions",children:[e.jsx("h4",{children:"How to Use:"}),e.jsxs("ol",{children:[e.jsx("li",{children:'Click "Copy to Clipboard" on your preferred embed option'}),e.jsx("li",{children:"Paste the code into your website HTML"}),e.jsx("li",{children:"The tour will display in an iframe"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," The responsive embed maintains a 16:9 aspect ratio and works well on all devices."]})]})]}),e.jsx("div",{className:"h3tm-modal-footer",children:e.jsx("button",{type:"button",className:"button button-secondary",onClick:u,style:{padding:"8px 16px",lineHeight:"1.5",minHeight:"32px",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:"Close"})})]})}):null},je={initial:{x:0,y:0},animate:{x:20,y:-20,opacity:.9}},we={initial:{opacity:0},animate:{opacity:1}};function be(){return e.jsx("div",{className:"flex bg-gray-100 dark:bg-neutral-900 flex-shrink-0 flex-wrap justify-center items-center gap-x-px gap-y-px scale-105",children:Array.from({length:11}).map((D,w)=>Array.from({length:41}).map((b,d)=>{const j=w*41+d;return e.jsx("div",{className:`w-10 h-10 flex flex-shrink-0 rounded-[2px] ${j%2===0?"bg-gray-50 dark:bg-neutral-950":"bg-gray-50 dark:bg-neutral-950 shadow-[0px_0px_1px_3px_rgba(255,255,255,1)_inset] dark:shadow-[0px_0px_1px_3px_rgba(0,0,0,1)_inset]"}`},`${d}-${w}`)}))})}function ve({isOpen:p,onClose:u,tourId:D,tourName:w,onUpdateComplete:b}){const[d,j]=c.useState(null),[m,v]=c.useState(!1),[N,g]=c.useState(0),[l,T]=c.useState(!1),[x,P]=c.useState("uploading"),R=c.useRef(null),M=t=>{if(t.length>0){const a=t[0];a.name.endsWith(".zip")&&j(a)}},I=()=>{var t;(t=R.current)==null||t.click()},{getRootProps:O,isDragActive:S}=oe({multiple:!1,noClick:!0,accept:{"application/zip":[".zip"]},onDrop:M}),A=async()=>{var t,a;if(d){v(!0),g(0),P("uploading");try{const s=await L(d,D),i=s.s3_key;if(!i)throw new Error("Server did not return s3_key");await $(d,s),P("processing"),g(0);const r=new FormData;r.append("action","h3tm_update_tour"),r.append("tour_id",D),r.append("s3_key",i),r.append("nonce",((t=window.h3tm_ajax)==null?void 0:t.nonce)||"");const o=await(await fetch(((a=window.h3tm_ajax)==null?void 0:a.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:r})).json();if(o.success)g(100),T(!0),setTimeout(()=>{v(!1),T(!1),j(null),g(0),u(),b==null||b()},1500);else throw new Error(o.data||"Unknown error")}catch(s){console.error("Error updating tour:",s),alert(`Failed to update tour: ${s instanceof Error?s.message:"Unknown error"}`),v(!1),g(0)}}},L=async(t,a)=>{var o,_,F;const s=new FormData;s.append("action","h3tm_get_s3_presigned_url"),s.append("tour_id",a),s.append("file_name",t.name),s.append("file_size",t.size.toString()),s.append("file_type",t.type||"application/zip"),s.append("is_update","true"),s.append("nonce",((o=window.h3tm_ajax)==null?void 0:o.nonce)||"");const i=await fetch(((_=window.h3tm_ajax)==null?void 0:_.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:s});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const r=await i.text();let h;try{h=JSON.parse(r)}catch{throw new Error(`Invalid JSON response: ${r.substring(0,200)}`)}if(!h.success)throw new Error(((F=h.data)==null?void 0:F.message)||h.data||"Failed to get upload URL");return h.data},$=async(t,a)=>new Promise((s,i)=>{const r=new XMLHttpRequest;r.upload.addEventListener("progress",o=>{if(o.lengthComputable){const _=Math.round(o.loaded/o.total*100);g(_)}}),r.addEventListener("load",()=>{r.status>=200&&r.status<300?s():i(new Error(`S3 upload failed: ${r.status} ${r.statusText}`))}),r.addEventListener("error",()=>{i(new Error("Network error during upload"))}),r.addEventListener("abort",()=>{i(new Error("Upload cancelled"))}),r.open("PUT",a.upload_url),r.timeout=3e5;const h=t.type||"application/zip";r.setRequestHeader("Content-Type",h),r.send(t)}),k=()=>{m||(j(null),g(0),u())};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{open:p&&!m,onOpenChange:k,children:e.jsxs(Q,{className:"sm:max-w-2xl",children:[e.jsxs(Z,{children:[e.jsxs(ee,{children:["Update Tour: ",w]}),e.jsx(te,{children:"Upload a new version of this tour. The current version will be archived automatically."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"rounded-lg bg-amber-50 border border-amber-200 p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm font-medium text-amber-900",children:"Important: This will archive and replace your current tour"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ie,{className:"text-sm font-medium",children:"Tour File (.zip)"}),e.jsx("div",{className:"border-2 border-dashed rounded-lg bg-background hover:bg-accent/5 transition-colors",...O(),children:e.jsxs(E.div,{onClick:I,whileHover:"animate",className:"p-8 cursor-pointer w-full relative overflow-hidden",children:[e.jsx("input",{ref:R,id:"file-upload-handle",type:"file",accept:".zip",onChange:t=>M(Array.from(t.target.files||[])),className:"hidden"}),e.jsx("div",{className:"absolute inset-0 [mask-image:radial-gradient(ellipse_at_center,white,transparent)]",children:e.jsx(be,{})}),e.jsxs("div",{className:"flex flex-col items-center justify-center relative z-10",children:[e.jsx("div",{className:"relative w-full max-w-xl mx-auto",children:d?e.jsx(E.div,{layoutId:"file-upload",className:"relative overflow-hidden z-40 bg-card border border-border flex flex-col items-start justify-start p-4 w-full mx-auto rounded-md shadow-sm",children:e.jsxs("div",{className:"flex justify-between w-full items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(le,{className:"h-5 w-5 text-blue-500"}),e.jsx(E.p,{initial:{opacity:0},animate:{opacity:1},className:"text-sm font-medium text-foreground truncate max-w-xs",children:d.name})]}),e.jsxs(E.p,{initial:{opacity:0},animate:{opacity:1},className:"rounded-md px-2 py-1 text-xs bg-blue-500/10 text-blue-600 dark:text-blue-400",children:[(d.size/(1024*1024)).toFixed(2)," MB"]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(E.div,{layoutId:"file-upload",variants:je,transition:{type:"spring",stiffness:300,damping:20},className:"relative group-hover/file:shadow-lg z-40 bg-card border border-border flex items-center justify-center h-32 w-full max-w-[8rem] mx-auto rounded-md transition-shadow",children:S?e.jsxs(E.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center text-blue-500",children:[e.jsx("span",{className:"text-xs mb-1",children:"Drop it"}),e.jsx(J,{className:"h-5 w-5"})]}):e.jsx(J,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx(E.div,{variants:we,className:"absolute opacity-0 border-2 border-dashed border-blue-400 inset-0 z-30 bg-transparent flex items-center justify-center h-32 w-full max-w-[8rem] mx-auto rounded-md"})]})}),!d&&e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Upload .zip file"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Drag and drop or click to browse"})]})]})]})})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Upload Progress"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[N,"%"]})]}),e.jsx(ae,{value:N,className:"h-2"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(B,{onClick:A,disabled:!d||m,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:m?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Update Tour"]})}),e.jsx(B,{onClick:k,disabled:m,variant:"outline",children:"Cancel"})]})]})]})}),e.jsx(Y,{open:m,onOpenChange:()=>{},children:e.jsxs(Q,{className:"sm:max-w-md",children:[e.jsxs(Z,{children:[e.jsx(ee,{children:l?"Update Complete!":x==="uploading"?"Uploading to S3":"Processing Update"}),e.jsx(te,{children:l?"Your tour has been updated successfully.":x==="uploading"?"Uploading your updated tour file to AWS S3...":"Archiving current version and deploying updated tour..."})]}),e.jsx("div",{className:"space-y-4 py-4",children:l?e.jsxs("div",{className:"flex flex-col items-center justify-center py-6",children:[e.jsx(E.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15},children:e.jsx(ne,{className:"h-16 w-16 text-green-500"})}),e.jsx("p",{className:"mt-4 text-sm font-medium",children:w})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:x==="uploading"?"Upload Progress":"Processing Progress"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[N,"%"]})]}),e.jsx(ae,{value:N,className:"h-2"})]}),x==="uploading"?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(z,{className:"h-4 w-4 animate-spin text-blue-500"}),e.jsxs("span",{children:["Uploading ",d==null?void 0:d.name,"..."]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(z,{className:"h-4 w-4 animate-spin text-blue-500"}),e.jsx("span",{children:"Processing tour update..."})]}),e.jsxs("div",{className:"pl-6 space-y-1 text-xs text-muted-foreground",children:[e.jsx("div",{children:"â€¢ Archiving current version"}),e.jsx("div",{children:"â€¢ Downloading from S3"}),e.jsx("div",{children:"â€¢ Extracting tour files"}),e.jsx("div",{children:"â€¢ Deploying to tours directory"}),e.jsx("div",{children:"â€¢ Invalidating CloudFront cache"})]})]})]})})]})})]})}function Ne({onRefresh:p}){const[u,D]=c.useState([]),[w,b]=c.useState(!0),[d,j]=c.useState(null),[m,v]=c.useState(""),[N,g]=c.useState(!1),[l,T]=c.useState({tourName:"",tourUrl:"",embedScript:"",embedScriptResponsive:""}),[x,P]=c.useState(!1),[R,M]=c.useState(""),[I,O]=c.useState("");c.useEffect(()=>{S()},[]);const S=async()=>{var t,a;b(!0);try{const s=new FormData;s.append("action","h3tm_list_s3_tours"),s.append("nonce",((t=window.h3tm_ajax)==null?void 0:t.nonce)||"");const r=await(await fetch(((a=window.h3tm_ajax)==null?void 0:a.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:s})).json();if(r.success&&r.data){const h=Array.isArray(r.data)?r.data:r.data.tours||[];D(h.map(o=>{const _=typeof o=="object"&&o.tour_slug?o.tour_slug:typeof o=="string"?o:o.name;return{name:typeof o=="string"?o:o.name,url:window.location.origin+"/h3panos/"+encodeURIComponent(_),status:typeof o=="string"?"completed":o.status,tour_id:typeof o=="string"?void 0:o.tour_id,updated_date:typeof o=="string"?void 0:o.updated_date}}))}}catch(s){console.error("Error loading tours:",s)}finally{b(!1)}},A=t=>{j(t),v(t)},L=()=>{j(null),v("")},$=async t=>{var a,s;if(m===t||!m.trim()){L();return}try{const i=new FormData;i.append("action","h3tm_rename_tour"),i.append("old_name",t),i.append("new_name",m),i.append("nonce",((a=window.h3tm_ajax)==null?void 0:a.nonce)||""),(await(await fetch(((s=window.h3tm_ajax)==null?void 0:s.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:i})).json()).success&&(await S(),L())}catch(i){console.error("Error renaming tour:",i)}},k=async(t,a,s,i)=>{var r,h,o,_,F,H,X,G,K;switch(t){case"view":window.open(s,"_blank");break;case"changeUrl":const q=prompt("Enter new URL slug (e.g., my-custom-tour-name):",s==null?void 0:s.split("/").pop());if(q&&q.trim())try{let n=q.trim();if(n.includes("/")&&(n=n.split("/").filter(V=>V).pop()||""),!n||n.length===0){alert("Invalid URL slug. Please enter a valid slug.");return}const f=new FormData;f.append("action","h3tm_change_tour_url"),f.append("tour_name",a),f.append("new_slug",n),f.append("nonce",((r=window.h3tm_ajax)==null?void 0:r.nonce)||"");const C=await(await fetch(((h=window.h3tm_ajax)==null?void 0:h.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:f})).json();C.success?(alert(`URL changed successfully for "${a}"
New URL: /h3panos/${n}`),await S()):alert(`Failed to change URL: ${C.data||"Unknown error"}`)}catch(n){console.error("Error changing URL:",n),alert("Failed to change URL. Check console for details.")}break;case"update":if(!i){alert("Cannot update legacy tour without tour_id. Please re-upload as a new tour.");return}M(i),O(a),P(!0);break;case"rename":A(a);break;case"getScript":try{const n=new FormData;n.append("action","h3tm_get_embed_script"),n.append("tour_name",a),n.append("nonce",((o=window.h3tm_ajax)==null?void 0:o.nonce)||"");const y=await(await fetch(((_=window.h3tm_ajax)==null?void 0:_.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:n})).json();y.success&&y.data?(T({tourName:y.data.tour_name,tourUrl:y.data.tour_url,embedScript:y.data.embed_script,embedScriptResponsive:y.data.embed_script_responsive}),g(!0)):alert(`Failed to get script: ${y.data||"Unknown error"}`)}catch(n){console.error("Error getting script:",n),alert("Failed to get embed script. Check console for details.")}break;case"delete":if(confirm(`Are you sure you want to archive "${a}"? The tour will be moved to the archive folder and permanently deleted after 90 days.`))try{console.log("ðŸ—‘ï¸ Delete Request Starting:",{tourName:a,ajaxUrl:(F=window.h3tm_ajax)==null?void 0:F.ajax_url,hasNonce:!!((H=window.h3tm_ajax)!=null&&H.nonce),timestamp:new Date().toISOString()});const n=new FormData;n.append("action","h3tm_delete_tour"),n.append("tour_name",a),n.append("nonce",((X=window.h3tm_ajax)==null?void 0:X.nonce)||""),console.log("ðŸ“¤ Sending DELETE request to:",((G=window.h3tm_ajax)==null?void 0:G.ajax_url)||"/wp-admin/admin-ajax.php");const f=await fetch(((K=window.h3tm_ajax)==null?void 0:K.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",body:n});console.log("ðŸ“¥ Response received:",{status:f.status,statusText:f.statusText,ok:f.ok,headers:{contentType:f.headers.get("content-type")}});const y=await f.text();console.log("ðŸ“„ Raw response body:",y);let C;try{C=JSON.parse(y)}catch(V){console.error("âŒ JSON parse error:",V),console.error("Raw response that failed to parse:",y),alert(`Server returned invalid JSON response. Check console for details.

Response preview: ${y.substring(0,200)}`);return}console.log("âœ… Parsed response:",C),C.success?(console.log("âœ“ Delete successful, reloading tours..."),await S(),alert(`Tour "${a}" archived successfully! ${C.data||""}`)):(console.error("âŒ Delete failed:",C.data),alert(`Failed to delete: ${C.data||"Unknown error"}

Check WordPress error logs for "H3TM S3 Archive:" messages.`))}catch(n){console.error("ðŸ’¥ Delete operation exception:",{error:n,errorMessage:n instanceof Error?n.message:String(n),errorStack:n instanceof Error?n.stack:void 0,tourName:a}),alert(`Failed to delete tour "${a}".

Error: ${n instanceof Error?n.message:String(n)}

Check browser console and WordPress error logs for more details.`)}break}};return w?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(z,{className:"h-8 w-8 animate-spin text-blue-500"})}):u.length===0?e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"rounded-full bg-gray-100 p-3",children:e.jsx(se,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No tours available"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload your first tour to get started"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{isOpen:N,onClose:()=>g(!1),tourName:l.tourName,tourUrl:l.tourUrl,embedScript:l.embedScript,embedScriptResponsive:l.embedScriptResponsive}),e.jsx(ve,{isOpen:x,onClose:()=>P(!1),tourId:R,tourName:I,onUpdateComplete:()=>{S(),p==null||p()}}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[u.length," ",u.length===1?"tour":"tours"," found"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(B,{onClick:()=>{S(),p==null||p()},variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Refresh"]})})]}),e.jsx("div",{className:"rounded-lg border border-gray-200 overflow-hidden bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tour Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"URL"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Updated"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d===t.name?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{value:m,onChange:a=>v(a.target.value),onKeyDown:a=>{a.key==="Enter"&&$(t.name),a.key==="Escape"&&L()},className:"h-8 text-sm",autoFocus:!0}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>$(t.name),className:"p-1 hover:bg-green-50 rounded text-green-600",title:"Save",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx("button",{onClick:L,className:"p-1 hover:bg-red-50 rounded text-red-600",title:"Cancel",children:e.jsx(ue,{className:"h-4 w-4"})})]})]}):e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.name}),t.status&&t.status!=="completed"&&e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="processing"?"bg-yellow-100 text-yellow-800":t.status==="uploading"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t.status})]}),t.tour_id&&e.jsxs("span",{className:"text-xs font-mono text-gray-500",title:"Tour ID (immutable identifier)",children:["ID: ",t.tour_id]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline truncate block max-w-md",children:t.url})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-500",children:t.updated_date?new Date(t.updated_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>k("view",t.name,t.url,t.tour_id),className:"p-2 hover:bg-blue-50 rounded-md transition-colors group",title:"View Tour",children:e.jsx(se,{className:"h-4 w-4 text-gray-500 group-hover:text-blue-600"})}),e.jsx("button",{onClick:()=>k("changeUrl",t.name,t.url,t.tour_id),className:"p-2 hover:bg-purple-50 rounded-md transition-colors group",title:"Change URL",children:e.jsx(he,{className:"h-4 w-4 text-gray-500 group-hover:text-purple-600"})}),e.jsx("button",{onClick:()=>k("rename",t.name,t.url,t.tour_id),className:"p-2 hover:bg-amber-50 rounded-md transition-colors group",title:"Rename Tour",children:e.jsx(ge,{className:"h-4 w-4 text-gray-500 group-hover:text-amber-600"})}),e.jsx("button",{onClick:()=>k("update",t.name,t.url,t.tour_id),className:"p-2 hover:bg-green-50 rounded-md transition-colors group",title:"Update Tour",disabled:!t.tour_id,children:e.jsx(re,{className:`h-4 w-4 ${t.tour_id?"text-gray-500 group-hover:text-green-600":"text-gray-300"}`})}),e.jsx("button",{onClick:()=>k("getScript",t.name,t.url,t.tour_id),className:"p-2 hover:bg-indigo-50 rounded-md transition-colors group",title:"Get Script",children:e.jsx(xe,{className:"h-4 w-4 text-gray-500 group-hover:text-indigo-600"})}),e.jsx("button",{onClick:()=>k("delete",t.name,t.url,t.tour_id),className:"p-2 hover:bg-red-50 rounded-md transition-colors group",title:"Delete Tour",children:e.jsx(ye,{className:"h-4 w-4 text-gray-500 group-hover:text-red-600"})})]})})]},t.tour_id||t.name))})]})})})]})]})}console.log("Tours Table script loaded");const W=document.getElementById("h3tm-tours-table-root");console.log("Looking for tours table container:",W);W?(console.log("Mounting Tours Table component"),ce(W).render(e.jsx(pe.StrictMode,{children:e.jsx(Ne,{onRefresh:()=>{console.log("Tours table refreshed")}})})),console.log("Tours Table mounted successfully")):console.error("Could not find h3tm-tours-table-root container!");
